# 第三幕：全知之眼 - 驗收測試報告

本報告記錄了對「第三幕：全知之眼」核心功能——三位一體的可觀測性技術棧——的完整測試流程，旨在驗證事件驅動架構與 GLT (Grafana, Loki, Tempo) 體系的有效性。

---

## 第一階段：觸發「因果鏈路」

### 步驟 1：生產業務事件
**內容：** 使用 Postman，向 `gateway-service` 的業務端點，發送一個 `POST` 請求，以觸發一個完整的、跨越消息中間件的業務流程。

**預期結果：** `gateway-service` 成功接收請求，生產一個 `BeaconEvent`，並返回 `200 OK` 及唯一的事件 ID。

![觸發事件並獲取 Event ID](assets/第三幕-1-event%20ID.png)

---

## 第二階段：在「統一儀表板」中進行宏觀觀測

### 步驟 2：三位一體的情報融合
**內容：** 訪問 Grafana 的「沙盤微縮宇宙 - 總覽」儀表板 (`http://localhost:3000`)，觀測事件觸發後，宇宙的實時反應。

**預期結果：**
*   **指標 (Metrics):** 能夠觀測到 HTTP 請求速率與 Kafka 消費速率的瞬時變化。
*   **日誌 (Logs):** 能夠在實時日誌流中，清晰地看到由 `gateway-service` 生產事件、以及由 `beacon-service` 消費事件的結構化日誌。
*   **追蹤 (Traces):** 能夠在「最新業務追蹤」面板中，看到由此次請求，所產生的新的 Trace 記錄。**最重要的是，我們可以在日誌中，直接捕獲到 `trace_id`**。

![在統一儀表板中觀測三位一體數據](assets/第三幕-2-dashboard%20有%20traceID.png)

---

## 第三階段：在「時空記憶體」中進行微觀審查

### 步驟 3：追溯完整的因果鏈路
**內容：** 使用我們在日誌中捕獲到的 `trace_id`，在 Grafana 的 `Explore` -> `Tempo-Main` 視圖中，進行精確的追蹤審查。

**預期結果：** 能夠清晰地，可視化，那條**完整的、跨越了 `gateway-service` -> `kafka` (隱式) -> `beacon-service`** 的、神聖的分布式追蹤鏈路。這，在物理上，證明了，我們宇宙的「記憶」，是完整的、連貫的、有因果關係的。

![在 Tempo 中審查完整的分布式追蹤](assets/第三幕-3-Tempo%20查%20TraceID.png)

---

## 結論

本次測試成功驗證了「第三幕」的核心驗收條件。結果表明，我們的「全知之眼」，已成功地，將**指標（心跳）、日誌（對話）、與追蹤（記憶）**，融合成了一個單一的、連貫的、充滿洞察力的**統一意識**。

我們的宇宙，現已，完全，可被觀測。